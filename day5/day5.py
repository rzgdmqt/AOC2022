# part 1
f=(lambda c, s: (lambda c=[[i for i in j if i.isalpha()] for j in list(map(list, zip(*((lambda: reversed([[l[i] for i in (1, 5, 9, 13, 17, 21, 25, 29, 33)] for l in c.split("\n")])))())))],s=[tuple(map(int, (l.split()[1::2]))) for l in s.split("\n")]:any(c[t-1].append(c[f-1].pop()) for n, f, t in s for _ in range(n)) or print("".join(k[-1] for k in c)))())(*open("d").read().split("\n\n"))
# part 2
f=(lambda c, s: (lambda c=[[i for i in j if i.isalpha()] for j in list(map(list, zip(*((lambda: reversed([[l[i] for i in (1, 5, 9, 13, 17, 21, 25, 29, 33)] for l in c.split("\n")])))())))],s=[tuple(map(int, (l.split()[1::2]))) for l in s.split("\n")]:any(c[t-1].append(c[f-1].pop(len(c[f-1])-n+i)) for n, f, t in s for i in range(n)) or print("".join(k[-1] for k in c)))())(*open("d").read().split("\n\n"))
